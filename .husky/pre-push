#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "ğŸš€ Pre-push ellenÅ‘rzÃ©sek indulnak..."

# TypeScript check on modified files
echo "ğŸ” TypeScript ellenÅ‘rzÃ©s..."
npm run check:typescript-modified
if [ $? -ne 0 ]; then
  echo "âŒ TypeScript hibÃ¡k! Push megszakÃ­tva."
  exit 1
fi

# Code quality check on modified files
echo "ğŸ” KÃ³dminÅ‘sÃ©g ellenÅ‘rzÃ©s..."
npm run check:modified
if [ $? -ne 0 ]; then
  echo "âŒ KÃ³dminÅ‘sÃ©g hibÃ¡k! Push megszakÃ­tva."
  exit 1
fi

# Run tests if they exist
if npm run test:unit:changed > /dev/null 2>&1; then
  echo "ğŸ§ª Tesztek futtatÃ¡sa..."
  npm run test:unit:changed
  if [ $? -ne 0 ]; then
    echo "âŒ Teszt hibÃ¡k! Push megszakÃ­tva."
    exit 1
  fi
fi

# Build check
echo "ğŸ—ï¸ Build ellenÅ‘rzÃ©s..."
npm run build
if [ $? -ne 0 ]; then
  echo "âŒ Build hiba! Push megszakÃ­tva."
  exit 1
fi

echo "âœ… Minden ellenÅ‘rzÃ©s sikeres. Push mehet!"
