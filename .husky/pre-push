#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "🚀 Pre-push ellenőrzések indulnak..."

# TypeScript check on modified files
echo "🔍 TypeScript ellenőrzés..."
npm run check:typescript-modified
if [ $? -ne 0 ]; then
  echo "❌ TypeScript hibák! Push megszakítva."
  exit 1
fi

# Code quality check on modified files
echo "🔍 Kódminőség ellenőrzés..."
npm run check:modified
if [ $? -ne 0 ]; then
  echo "❌ Kódminőség hibák! Push megszakítva."
  exit 1
fi

# Run tests if they exist
if npm run test:unit:changed > /dev/null 2>&1; then
  echo "🧪 Tesztek futtatása..."
  npm run test:unit:changed
  if [ $? -ne 0 ]; then
    echo "❌ Teszt hibák! Push megszakítva."
    exit 1
  fi
fi

# Build check
echo "🏗️ Build ellenőrzés..."
npm run build
if [ $? -ne 0 ]; then
  echo "❌ Build hiba! Push megszakítva."
  exit 1
fi

echo "✅ Minden ellenőrzés sikeres. Push mehet!"
